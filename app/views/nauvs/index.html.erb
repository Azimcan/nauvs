<% html_title "Nauvs" %>

<h2>Nauvs</h2>

<% @issues.each do |issue| %>
	<table>
		<thead>
			<tr>
				<th>Issue Id</th>
				<th>Journal Id</th>
				<th>User</th>
				<th>prop_key</th>
				<th>old_value</th>
				<th>value</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><%= issue.id %></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<% issue.journals.each do |journal| %>
				<tr>
					<td></td>
					<td><%= journal.id %></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
				</tr>
					<% journal.details.each do |detail| %>
						<% if detail.prop_key == "status_id" || detail.prop_key == "category_id" %>
							<tr>
								<td></td>
								<td></td>
								<td><%= journal.user %></td>
								<td><%= detail.prop_key %></td>
								<td><%= detail.prop_key == "status_id" ? IssueStatus.find( detail.old_value ) : IssueCategory.find( details.old_value ) %></td>
								<td><%= detail.prop_key == "status_id" ? IssueStatus.find( detail.value ) : IssueCategory.find( details.value ) %></td>
							</tr>
						<% end -%>
				<% end %>
			<% end %>
		</tbody>
	</table>
	<hr>
<% end %>

<% if @issues == [] %>
	<h4>No issues</h2>
<% end -%>

<style>
	table {
		font-family: arial, sans-serif;
		border-collapse: collapse;
		width: 100%;
	}

	th {
		background-color: #4D4D4D;
		border: 1px solid #BABDB6;
		color: #ffffff;
		text-align: left;
		padding: 8px;
		width: 10%;
	}

	td {
		border: 1px solid #BABDB6;
		text-align: left;
		padding: 8px;
		width: 10%;
	}

	tr:nth-child(even) {
		background-color: #D3D7CF;
	}
	hr {
		display: block;
		height: 1px;
		border: 0;
		border-top: 1px solid #A40000;
		margin: 1em 0;
		padding: 0; 
	}
</style>